# توثيق مشروع Hexashop للتجارة الإلكترونية

## 1. نظرة عامة

هذا المشروع عبارة عن تطبيق ويب أساسي للتجارة الإلكترونية تم إنشاؤه باستخدام PHP و MySQL. يتضمن واجهة أمامية للعملاء لتصفح المنتجات وإدارة عربة التسوق الخاصة بهم، ولوحة تحكم للمسؤول لإدارة المنتجات والأقسام والمستخدمين والطلبات.

## 2. الميزات

### الواجهة الأمامية:
*   عرض المنتجات حسب القسم (رجال، نساء، إلخ) في الصفحة الرئيسية.
*   عرض تفاصيل المنتج الواحد (`single-product.php`).
*   تسجيل مستخدم جديد (`signup.php`) وتسجيل الدخول (`signin.php`).
*   إضافة المنتجات إلى عربة التسوق (تعتمد على الجلسة - Session).
*   عرض وإدارة عربة التسوق (`cart.php`).
*   تسجيل خروج المستخدم (`logout.php`).
*   (هيكل أساسي لأقسام أخرى مثل "حولنا"، "اتصل بنا").

### لوحة التحكم (`/admin/`):
*   تسجيل دخول آمن للمستخدمين المسؤولين فقط.
*   نظرة عامة في لوحة التحكم (`admin/index.php`).
*   **إدارة المنتجات:** عرض، إضافة، تعديل، حذف المنتجات (بما في ذلك تحميل الصور).
*   **إدارة الأقسام:** عرض، إضافة، تعديل، حذف الأقسام.
*   **إدارة المستخدمين:** عرض المستخدمين، إضافة مستخدمين جدد (مسؤول/عميل)، تعديل نوع المستخدم (مسؤول/عميل)، حذف المستخدمين.
*   **إدارة الطلبات:** عرض قائمة الطلبات، عرض تفاصيل الطلب (معلومات العميل، المنتجات)، تحديث حالة الطلب.
*   تصميم متجاوب (يتكيف مع الشاشات الصغيرة).

## 3. التقنيات المستخدمة

*   **الخادم (Backend):** PHP (أسلوب إجرائي/مختلط)
*   **قاعدة البيانات:** MySQL / MariaDB
*   **الواجهة (Frontend):** HTML, CSS, JavaScript (بما في ذلك jQuery و Bootstrap أساسي لتنسيق لوحة التحكم)
*   **خادم الويب:** Apache (كجزء من XAMPP) أو خادم مشابه متوافق مع PHP.

## 4. تعليمات الإعداد

اتبع هذه الخطوات لإعداد المشروع على جهازك المحلي أو خادم جديد.

### المتطلبات الأساسية:
*   بيئة خادم ويب (مثل XAMPP, WAMP, MAMP, أو LAMP/LEMP قياسية) تحتوي على:
    *   PHP (يوصى بالإصدار 7.4 أو أحدث)
    *   خادم قاعدة بيانات MySQL أو MariaDB
    *   خادم ويب Apache أو Nginx

### الخطوة 1: إعداد قاعدة البيانات
1.  **إنشاء قاعدة بيانات:** باستخدام أداة مثل phpMyAdmin أو سطر أوامر MySQL، قم بإنشاء قاعدة بيانات جديدة. لنفترض أنك سميتها `ecommerce_db`.
2.  **استيراد SQL:** قم باستيراد ملف `ecommerce.sql` المرفق إلى قاعدة البيانات التي أنشأتها (`ecommerce_db`). سيؤدي هذا إلى إنشاء الجداول اللازمة (`users`, `products`, `categories`, `orders`, `order_items`).
3.  **المستخدم المسؤول:** قد يحتوي ملف SQL على مستخدم مسؤول افتراضي. إذا لم يكن كذلك، يمكنك:
    *   تسجيل مستخدم جديد عبر الواجهة الأمامية (`signup.php`).
    *   تغيير حقل `user_type` لهذا المستخدم يدويًا في جدول `users` من 'customer' إلى 'admin' باستخدام phpMyAdmin أو استعلام SQL UPDATE.

### الخطوة 2: وضع الملفات
1.  **نسخ الملفات:** انسخ جميع ملفات ومجلدات المشروع (`admin`, `assets`, `index.php`, `config.php`, إلخ) إلى الدليل المناسب لخادم الويب الخاص بك.
    *   بالنسبة لـ XAMPP/WAMP: عادةً `C:/xampp/htdocs/` أو `C:/wamp/www/`. يمكنك وضع ملفات المشروع مباشرة في `htdocs` أو إنشاء مجلد فرعي (مثل `htdocs/hexashop/`). سيكون عنوان URL للوصول هو `http://localhost/` أو `http://localhost/hexashop/`.
    *   بالنسبة لـ Linux LAMP: غالبًا `/var/www/html/`.

### الخطوة 3: الإعدادات (Configuration)
1.  **تعديل `config.php`:** افتح ملف `config.php` الموجود في الدليل الجذر للمشروع.
2.  **تحديث بيانات الاتصال بقاعدة البيانات:** قم بتعديل الأسطر التالية بتفاصيل الاتصال بقاعدة البيانات الفعلية الخاصة بك:
    ```php
    define('DB_SERVER', 'localhost'); // اتركه 'localhost' إذا كانت قاعدة البيانات على نفس الخادم
    define('DB_USERNAME', 'YOUR_DB_USERNAME'); // استبدله باسم مستخدم MySQL الخاص بك (مثل 'root')
    define('DB_PASSWORD', 'YOUR_DB_PASSWORD'); // استبدله بكلمة مرور MySQL الخاصة بك (غالبًا ما تكون فارغة للمستخدم root الافتراضي في XAMPP)
    define('DB_NAME', 'ecommerce_db'); // استبدله بالاسم الذي اخترته في الخطوة 1
    ```
3.  **مسار الجلسات (اختياري):** عادةً ما تتعامل PHP مع الجلسات بشكل صحيح. ومع ذلك، إذا واجهت أخطاء متعلقة بالجلسات، فتأكد من أن `session.save_path` في ملف إعدادات `php.ini` الخاص بك صالح وقابل للكتابة بواسطة خادم الويب. يبدأ ملف `config.php` الجلسة (`session_start()`).

### الخطوة 4: الصلاحيات (خاصة لنظامي Linux/macOS)
1.  **تحميل الصور:** تأكد من أن خادم الويب لديه صلاحيات الكتابة لدليل تحميل الصور: `assets/images/`. قد تحتاج إلى تشغيل أمر مثل `sudo chmod -R 775 assets/images` وربما `sudo chown -R www-data:www-data assets/images` (استبدل `www-data` بالمستخدم/المجموعة الخاصة بخادم الويب إذا كانت مختلفة). **ملاحظة:** لا يُنصح عمومًا باستخدام `777` في بيئة الإنتاج؛ استخدم الحد الأدنى من الصلاحيات المطلوبة.

### الخطوة 5: الوصول إلى الموقع
*   **الواجهة الأمامية:** افتح متصفح الويب الخاص بك وانتقل إلى عنوان URL للمشروع (مثل `http://localhost/` أو `http://localhost/your_project_folder/`).
*   **لوحة التحكم:** انتقل إلى دليل المسؤول (مثل `http://localhost/admin/` أو `http://localhost/your_project_folder/admin/`). قم بتسجيل الدخول باستخدام بيانات حساب المسؤول الذي قمت بإعداده.

## 5. دليل الاستخدام

### لوحة التحكم:
*   **تسجيل الدخول:** قم بالوصول إلى `/admin/` وقم بتسجيل الدخول باستخدام مستخدم من نوع 'admin'.
*   **لوحة المعلومات:** توفر روابط سريعة لإدارة الطلبات والمستخدمين.
*   **المنتجات:** عرض وإضافة وتعديل (بما في ذلك تغيير الصورة) وحذف المنتجات.
*   **الأقسام:** عرض وإضافة وتعديل وحذف الأقسام. يتم منع حذف قسم مستخدم من قبل المنتجات.
*   **المستخدمون:** عرض المستخدمين، إضافة مستخدمين جدد (عميل أو مسؤول)، تعديل نوع المستخدم (لا يمكن تعديل النوع الخاص بك)، حذف المستخدمين (لا يمكن حذف حسابك الخاص).
*   **الطلبات:** عرض جميع الطلبات. انقر فوق "عرض التفاصيل" لرؤية تفاصيل الطلب (المنتجات، معلومات العميل، العناوين إن وجدت) وتحديث حالة الطلب.

### الواجهة الأمامية:
*   **التصفح:** استكشف المنتجات في أقسام الصفحة الرئيسية.
*   **تفاصيل المنتج:** انقر فوق صورة المنتج أو الرابط للانتقال إلى `single-product.php` (بافتراض وجود هذه الصفحة وعرضها للتفاصيل).
*   **عربة التسوق:** استخدم أزرار "إضافة إلى العربة" (من المحتمل أن يكون التنفيذ في `single-product.php` أو عبر JS يرسل البيانات إلى `add_to_cart.php`). عرض محتويات عربة التسوق في `cart.php`.
*   **تسجيل الدخول/التسجيل:** استخدم روابط "تسجيل الدخول" / "تسجيل جديد". يرى المستخدمون المسجلون رسالة ترحيب وزر تسجيل الخروج. يرى المسؤولون رابطًا إضافيًا "Admin".

## 6. نظرة عامة على بنية الملفات

```
htdocs/
├── admin/                  # ملفات لوحة التحكم
│   ├── partials/           # الهيدر والفوتر للوحة التحكم
│   │   ├── header.php
│   │   └── footer.php
│   ├── add_category.php
│   ├── add_product.php
│   ├── add_user.php
│   ├── auth_check.php      # يتحقق من حالة تسجيل دخول المسؤول
│   ├── categories.php
│   ├── delete_category.php
│   ├── delete_product.php
│   ├── delete_user.php
│   ├── edit_category.php
│   ├── edit_product.php
│   ├── edit_user.php
│   ├── index.php           # لوحة التحكم الرئيسية
│   ├── orders.php
│   ├── products.php
│   ├── users.php
│   └── view_order.php
├── assets/                 # ملفات الواجهة الأمامية (CSS, JS, صور, خطوط)
│   ├── css/
│   ├── fonts/
│   ├── images/             # يتم تحميل صور المنتجات هنا
│   └── js/
├── add_to_cart.php         # سكربت لمعالجة إضافة المنتجات للعربة (غالبًا عبر POST/AJAX)
├── cart.php                # صفحة عربة التسوق
├── config.php              # الاتصال بقاعدة البيانات، بدء الجلسة، الإعدادات الرئيسية
├── ecommerce.sql           # مخطط قاعدة البيانات والبيانات الأولية
├── index.php               # الصفحة الرئيسية للواجهة الأمامية
├── logout.php              # سكربت تسجيل خروج المستخدم
├── signin.php              # صفحة تسجيل دخول المستخدم
├── signup.php              # صفحة تسجيل مستخدم جديد
└── single-product.php      # صفحة عرض المنتج الواحد في الواجهة الأمامية
```

## 7. النشر / نقل الخوادم

لنقل المشروع إلى خادم مختلف (مثل من XAMPP المحلي إلى بيئة استضافة حية):

1.  **قاعدة البيانات:**
    *   **تصدير:** قم بتصدير قاعدة البيانات الحالية (مثل من phpMyAdmin على جهازك المحلي) كملف SQL.
    *   **استيراد:** قم باستيراد ملف SQL هذا إلى قاعدة البيانات الجديدة على الخادم الهدف.
2.  **الملفات:**
    *   **نقل:** انسخ *جميع* ملفات ومجلدات المشروع إلى دليل الويب العام على الخادم الجديد (مثل `public_html`, `htdocs`, `/var/www/html`).
3.  **الإعدادات:**
    *   **تحديث `config.php`:** قم بتحرير ملف `config.php` على *الخادم الجديد* باستخدام بيانات اعتماد قاعدة البيانات الجديدة (الخادم، اسم المستخدم، كلمة المرور، اسم قاعدة البيانات) التي يوفرها مزود الاستضافة الخاص بك.
4.  **الصلاحيات:**
    *   **التحقق من `assets/images/`:** تأكد من أن دليل `assets/images/` لديه صلاحيات الكتابة الصحيحة لمستخدم خادم الويب على الخادم الجديد للسماح بتحميل الصور. قد تختلف الصلاحيات المطلوبة اعتمادًا على إعداد الخادم.
5.  **المسارات:**
    *   يستخدم الكود `__DIR__` في عدة أماكن (مثل `config.php`، مسارات تحميل الصور)، مما يساعد في جعل المسارات نسبية لموقع الملف الحالي. يجب أن يعمل هذا بشكل عام عند نقل الخوادم، ولكن تحقق مرة أخرى إذا واجهت مشكلات في تضمين الملفات أو مسارات الصور.
6.  **إصدار PHP والإعدادات:**
    *   تأكد من أن إصدار PHP للخادم الجديد متوافق (يفضل 7.4+).
    *   تحقق من إعدادات PHP ذات الصلة في `php.ini` على الخادم الجديد إذا لزم الأمر (مثل `upload_max_filesize`، `post_max_size` لتحميل الصور، مستويات الإبلاغ عن الأخطاء).

## 8. التحسينات المحتملة / العمل المستقبلي

*   **ترقيم الصفحات (Pagination):** إضافة ترقيم الصفحات إلى جداول المسؤول (المنتجات، المستخدمون، الطلبات، الأقسام) للتعامل بشكل أفضل مع مجموعات البيانات الكبيرة.
*   **البحث والتصفية:** تنفيذ وظائف البحث والتصفية في جداول المسؤول وربما في صفحة المتجر بالواجهة الأمامية.
*   **صفحة المتجر بالواجهة الأمامية:** إنشاء صفحة متجر مخصصة تعرض جميع المنتجات مع خيارات التصفية والفرز.
*   **عملية الدفع (Checkout):** تنفيذ عملية دفع مناسبة (`checkout.php`) بعد عربة التسوق، وجمع معلومات الشحن/الفواتير وحفظ تفاصيل الطلب بشكل صحيح.
*   **تكامل بوابة الدفع:** تكامل بوابة دفع (مثل Stripe، PayPal، إلخ).
*   **تحسينات أمنية:**
    *   تنفيذ حماية CSRF (Cross-Site Request Forgery) على جميع النماذج.
    *   تعزيز منع XSS (Cross-Site Scripting) (الاستمرار في استخدام `htmlspecialchars` بجد).
    *   إضافة تحقق أكثر قوة من المدخلات.
*   **تحسينات JavaScript:**
    *   استخدام AJAX لوظيفة "إضافة إلى العربة" أكثر سلاسة دون إعادة تحميل الصفحة.
    *   تنفيذ وظيفة تبديل الشريط الجانبي للمسؤول باستخدام JavaScript.
*   **معالجة الأخطاء والتسجيل (Logging):** تنفيذ رسائل خطأ أكثر سهولة للمستخدم وتسجيل قوي للأخطاء من جانب الخادم بدلاً من عرض أخطاء قاعدة البيانات مباشرة.
*   **إعادة تعيين كلمة المرور:** إضافة ميزة "نسيت كلمة المرور".
*   **إعادة الهيكلة/OOP:** التفكير في إعادة هيكلة الكود باستخدام مبادئ البرمجة كائنية التوجه (OOP) وربما آلية توجيه بسيطة (routing) أو إطار عمل مصغر لتنظيم أفضل مع نمو المشروع.
*   **تصميم الواجهة الأمامية:** فصل الهيدر والفوتر إلى ملفات تضمين (`partials/header.php`, `partials/footer.php`) للواجهة الأمامية، على غرار لوحة التحكم، لتجنب تكرار الكود.

---

يوفر هذا التوثيق دليلاً شاملاً لإعداد واستخدام وفهم مشروع Hexashop. تذكر الاحتفاظ بنسخ احتياطية من قاعدة البيانات والملفات الخاصة بك، خاصة قبل إجراء تغييرات كبيرة أو نقل الخوادم. 